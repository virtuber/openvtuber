import"./common/_commonjsHelpers-8c19dec8.js";import{r as o}from"./common/index-57a74e37.js";function w(b){let e;const n=new Set,u=(r,c)=>{const t=typeof r=="function"?r(e):r;if(t!==e){const s=e;e=c?t:Object.assign({},e,t),n.forEach(f=>f(e,s))}},i=()=>e,l=(r,c=i,t=Object.is)=>{let s=c(e);function f(){const R=c(e);if(!t(s,R)){const S=s;r(s=R,S)}}return n.add(f),()=>n.delete(f)},d={setState:u,getState:i,subscribe:(r,c,t)=>c||t?l(r,c,t):(n.add(r),()=>n.delete(r)),destroy:()=>n.clear()};return e=b(u,i,d),d}const g=typeof window=="undefined"?o.useEffect:o.useLayoutEffect;function x(b){const e=typeof b=="function"?w(b):b,n=(u=e.getState,i=Object.is)=>{const[,l]=o.useReducer(S=>S+1,0),a=e.getState(),p=o.useRef(a),d=o.useRef(u),r=o.useRef(i),c=o.useRef(!1),t=o.useRef();t.current===void 0&&(t.current=u(a));let s,f=!1;(p.current!==a||d.current!==u||r.current!==i||c.current)&&(s=u(a),f=!i(t.current,s)),g(()=>{f&&(t.current=s),p.current=a,d.current=u,r.current=i,c.current=!1});const R=o.useRef(a);return g(()=>{const S=()=>{try{const m=e.getState(),y=d.current(m);r.current(t.current,y)||(p.current=m,t.current=y,l())}catch(m){c.current=!0,l()}},j=e.subscribe(S);return e.getState()!==R.current&&S(),j},[]),f?s:t.current};return Object.assign(n,e),n[Symbol.iterator]=function*(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4"),yield n,yield e},n}export default x;
